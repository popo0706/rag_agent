"""
【概要】
OpenAI の埋め込みモデル **`text-embedding-3-small`** を使って
日本語クエリをベクトル（数値のリスト）へ変換する最小例です。

処理の流れは 3 ステップ:
 1) `OpenAIEmbeddings` を初期化（APIキーは環境変数 `OPENAI_API_KEY` から自動取得）
 2) 質問文 `query` を **embed_query** でベクトル化
 3) ベクトル長（要素数）と中身を `print` して確認
"""

# ============================================================
# ① 必要ライブラリのインポート
#    - langchain_openai : OpenAI 公式 API をラップした LangChain 拡張
#    - OpenAIEmbeddings : テキスト → ベクトル を行うクラス
# ============================================================
from langchain_openai import OpenAIEmbeddings

# ------------------------------------------------------------
# ② 埋め込みモデルを初期化
#    - model : 利用する埋め込みモデル名
#      text-embedding-3-small -> 512 次元ベクトルを返す（2025/06 時点）
# ------------------------------------------------------------
embeddings = OpenAIEmbeddings(model="text-embedding-3-small")

# ------------------------------------------------------------
# ③ ベクトル化したいテキストを用意
# ------------------------------------------------------------
query = "AWSのs3からデータを読み込むためのDocumentloaderはありますか？"

# ------------------------------------------------------------
# ④ クエリをベクトルへ変換
#    - embed_query : 1 つの文を埋め込み（List[float]）にするメソッド
# ------------------------------------------------------------
vector = embeddings.embed_query(query)

# ------------------------------------------------------------
# ⑤ 結果を表示
#    - len(vector) : ベクトルの次元数（512 になる想定）
#    - vector      : 数値のリスト本体
# ------------------------------------------------------------
print(len(vector))  # ← 512 と表示されれば成功
print(vector)  # ← 512 個の float が並ぶ

from langchain_chroma import Chroma

db = Chroma.form_documnets(docs, embeddings)
